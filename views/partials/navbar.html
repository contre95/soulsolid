{{define "navbar"}}
<nav id="top-navbar" class="top-0 left-0 z-100 w-full border-gray-200  transition-transform sm:hidden">
  <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
    <button id="navbar-toggle" type="button"
      class="fixed z-50 inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg bg-white bg-opacity-70 dark:bg-gray-800 dark:bg-opacity-70 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600">
      <span class="sr-only">Open main menu</span>
      <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M1 1h15M1 7h15M1 13h15" />
      </svg>
    </button>
     <a href="/" class="flex items-center space-x-3 rtl:space-x-reverse ml-auto">
        <img id="logo-ship" src="/img/galaxy.png" class="h-12 h-12 animate__animated animate__rotateIn" alt="Soulsolid">
        <span
          class="self-center mt-2 text-2xl font-semibold whitespace-nowrap text-right text-gray-800 dark:text-blue-300 dark:drop-shadow-[0_0_10px_rgba(59,130,246,0.8)] hover:text-blue-300 hover:drop-shadow-[0_0_15px_rgba(96,165,250,0.9)] transition-all duration-300">
        Soulsolid</span>
     </a>
        <div id="navbar-menu"
          class="fixed w-fit hidden z-50 bg-gray-200 dark:bg-gray-800 p-4 rounded-lg border-t border-gray-200 dark:border-gray-700 shadow-2xl transform -translate-x-full transition-transform duration-300 ease-in-out left-1 top-5">
      <ul class="space-y-2 font-medium">
        <li>
          <button type="button" class="w-full">
            <a hx-get="/ui/dashboard" hx-trigger="click,reloadDashboard from:body{{ .DashboardTrigger }}"
              hx-push-url="true" hx-swap="outerHTML" hx-target="#contenido"
              class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z" />
              </svg>
              <span class="mx-4">Dashboard</span>
            </a>
          </button>
        </li>
        <li>
          <button type="button" class="w-full">
            <a hx-get="/ui/library" hx-trigger="click,reloadLibrary from:body{{ .LibraryTrigger }}" hx-push-url="true"
              hx-swap="outerHTML" hx-target="#contenido"
              class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="m9 9 10.5-3m0 6.553v3.75a2.25 2.25 0 0 1-1.632 2.163l-1.32.377a1.803 1.803 0 1 1-.99-3.467l2.31-.66a2.25 2.25 0 0 0 1.632-2.163Zm0 0V2.25L9 5.25v10.303m0 0v3.75a2.25 2.25 0 0 1-1.632 2.163l-1.32.377a1.803 1.803 0 0 1-.99-3.467l2.31-.66A2.25 2.25 0 0 0 9 15.553Z" />
              </svg>
              <span class="mx-4">Library</span>
            </a>
          </button>
        </li>
        <li>
          <button type="button" class="w-full">
            <a hx-get="/ui/import" hx-trigger="click,reloadImport from:body{{ .ImportTrigger }}" hx-push-url="true"
              hx-swap="outerHTML" hx-target="#contenido"
              class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="size-6">
                <path d="M9 13H15M15 13L13 11M15 13L13 15M12.0627 6.06274L11.9373 5.93726C11.5914 5.59135 11.4184 5.4184 11.2166 5.29472C11.0376 5.18506 10.8425 5.10425 10.6385 5.05526C10.4083 5 10.1637 5 9.67452 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V15.8C3 16.9201 3 17.4802 3.21799 17.908C3.40973 18.2843 3.71569 18.5903 4.09202 18.782C4.51984 19 5.07989 19 6.2 19H17.8C18.9201 19 19.4802 19 19.908 18.782C20.2843 18.5903 20.5903 18.2843 20.782 17.908C21 17.4802 21 16.9201 21 15.8V10.2C21 9.0799 21 8.51984 20.782 8.09202C20.5903 7.71569 20.2843 7.40973 19.908 7.21799C19.4802 7 18.9201 7 17.8 7H14.3255C13.8363 7 13.5917 7 13.3615 6.94474C13.1575 6.89575 12.9624 6.81494 12.7834 6.70528C12.5816 6.5816 12.4086 6.40865 12.0627 6.06274Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>
              </svg>
              <span class="mx-4">Importing</span>
            </a>
          </button>
        </li>
        <li>
          <button type="button" class="w-full">
           <a
             hx-get="/ui/sync"
             hx-trigger="click,reloadSync from:body{{ .SyncTrigger }}"
             hx-push-url="true"
             hx-swap="outerHTML"
             hx-target="#contenido"
             class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer"
           >
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="size-6">
                <rect x="6" y="2" width="12" height="20" rx="2" ry="2" stroke="currentColor" fill="none"/>
                <circle cx="12" cy="17" r="2.5" stroke="currentColor" fill="none"/>
                <rect x="8" y="4" width="8" height="6" fill="none" stroke="currentColor"/>
             </svg>
             <span class="mx-4">DAP Sync</span>
           </a>
         </button>
       </li>

         <li>
           <button type="button" class="w-full">
             <a hx-get="/ui/jobs" hx-trigger="click,reloadJobs from:body{{ .JobsTrigger }}"
               hx-push-url="true" hx-swap="outerHTML" hx-target="#contenido"
               class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer">
             <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
               <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 7.5l3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0 0 21 18V6a2.25 2.25 0 0 0-2.25-2.25H5.25A2.25 2.25 0 0 0 3 6v12a2.25 2.25 0 0 0 2.25 2.25Z" />
             </svg>
               <span class="mx-4">Jobs</span>
             </a>
           </button>
         </li>
          <li>
            <div class="flex items-center px-4 py-2 mt-5 text-gray-600 dark:text-gray-400">
              <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" class="size-6"><path d="M232,136v64a8,8,0,0,1-8,8H32a8,8,0,0,1-8-8V136a8,8,0,0,1,8-8H224A8,8,0,0,1,232,136Z" opacity="0.2"></path><path d="M240,136v64a16,16,0,0,1-16,16H32a16,16,0,0,1-16-16V136a16,16,0,0,1,16-16H72a8,8,0,0,1,0,16H32v64H224V136H184a8,8,0,0,1,0-16h40A16,16,0,0,1,240,136Zm-117.66-2.34a8,8,0,0,0,11.32,0l48-48a8,8,0,0,0-11.32-11.32L136,108.69V24a8,8,0,0,0-16,0v84.69L85.66,74.34A8,8,0,0,0,74.34,85.66ZM200,168a12,12,0,1,0-12,12A12,12,0,0,0,200,168Z"></path></svg>
              <span class="mx-4 font-semibold">Downloaders</span>
            </div>
            <!-- Sub-buttons for each downloader -->
            <ul class="ml-6 mt-2 space-y-1">
              {{range $name, $downloader := .Downloaders}}
              <li>
                <button type="button" class="w-full">
                  <a hx-get="/ui/download?downloader={{$name}}" hx-trigger="click" hx-push-url="true" hx-swap="outerHTML" hx-target="#contenido"
                    class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-3 py-1.5 text-base text-gray-500 transition-colors duration-200 transform rounded-md dark:text-gray-500 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-300 hover:text-gray-600 dark:focus:bg-neutral-700 dark:focus:text-green-400 dark:hover:text-green-400 focus:outline-none cursor-pointer">
                     {{if $downloader.Icon}}
                     <img src="{{$downloader.Icon}}" class="size-4" alt="Downloader icon">
                     {{else}}
                     <img src="/img/generic-downloader.png" class="size-4" alt="Downloader icon">
                     {{end}}
                    <span class="mx-2 font-medium">{{capitalize $name}}</span>
                  </a>
                </button>
              </li>
              {{end}}
            </ul>
          </li>

        <li>
          <button type="button" class="w-full">
            <a hx-get="/ui/settings" hx-trigger="click,reloadSettings from:body{{ .SettingsTrigger }}"
              hx-push-url="true" hx-swap="outerHTML" hx-target="#contenido"
              class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round"
                  d="M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495" />
              </svg>
              <span class="mx-4">Settings</span>
            </a>
          </button>
        </li>
         <li>
           <button type="button" class="w-full">
             <a onclick="toggleDarkMode()"
               class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer">
               <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                 stroke="currentColor" class="size-6">
                 <path stroke-linecap="round" stroke-linejoin="round"
                   d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
               </svg>
               <span
                 class="mx-4 text-blue-400 dark:text-yellow-400 drop-shadow-[0_0_5px_rgba(59,130,246,0.6)] hover:text-blue-300 dark:hover:text-yellow-300 hover:drop-shadow-[0_0_8px_rgba(96,165,250,0.8)] transition-all duration-300">Dark/Light</span>
             </a>
           </button>
         </li>
         {{if .Demo}}
         <li>
           <hr class="border-gray-300 dark:border-gray-600">
         </li>
         <li>
           <button type="button" class="w-full">
              <a href="https://t.me/SoulsolidDemoBot" target="_blank"
               class="sidebtn hover:outline outline-gray-600 dark:outline-none flex items-center px-4 py-2 mt-5 text-gray-600 transition-colors duration-200 transform rounded-md dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-neutral-800 dark:hover:text-gray-200 hover:text-gray-700 dark:focus:bg-neutral-700 dark:focus:text-cyan-300 dark:hover:text-cyan-400 dark:focus:shadow-[inset_0_0_10px_rgba(0,255,255,0.2)] focus:outline-none cursor-pointer">
              <img src="/img/telegram.png" alt="Telegram" class="size-6">
               <span class="mx-4">Telegram</span>
             </a>
           </button>
         </li>
         {{end}}
      </ul>
    </div>
  </div>
</nav>

<script>
  // Navbar Menu interaction
  document.addEventListener('DOMContentLoaded', function () {
    const $targetEl = document.getElementById('navbar-menu');
    const $triggerEl = document.getElementById('navbar-toggle');
    const $navButtons = document.querySelectorAll('#navbar-menu a:not([onclick="toggleDarkMode()"]):not([href="https://t.me/SoulsolidDemoBot"])');
    const $navbar = document.getElementById('top-navbar');
    // Simple toggle function
    $triggerEl.addEventListener('click', function (e) {
      e.stopPropagation(); // Prevent event from bubbling to document
      if ($targetEl.classList.contains('hidden')) {
        $targetEl.classList.remove('hidden');
        // Force reflow
        $targetEl.offsetHeight;
        $targetEl.classList.remove('-translate-x-full');
      } else {
        $targetEl.classList.add('-translate-x-full');
        setTimeout(() => {
          $targetEl.classList.add('hidden');
        }, 300); // Match transition duration
      }
    });
    // Close menu when any button is pressed except Dark/Light button
    $navButtons.forEach(button => {
      button.addEventListener('click', function () {
        $targetEl.classList.add('-translate-x-full');
        setTimeout(() => {
          $targetEl.classList.add('hidden');
        }, 300); // Match transition duration
      });
    });
    // Close menu when clicking outside
    document.addEventListener('click', function (e) {
      // Check if the click was outside the navbar
      if (!$navbar.contains(e.target) && !$targetEl.classList.contains('hidden')) {
        $targetEl.classList.add('-translate-x-full');
        setTimeout(() => {
          $targetEl.classList.add('hidden');
        }, 300); // Match transition duration
      }
    });
    // Prevent clicks inside the menu from closing it
    $targetEl.addEventListener('click', function (e) {
      e.stopPropagation(); // Stop the click from reaching the document listener
    });
    // Swipe gesture support for mobile
    let touchStartX = 0;
    let touchStartY = 0;
    let touchEndX = 0;
    let touchEndY = 0;
    document.addEventListener('touchstart', function(e) {
      touchStartX = e.changedTouches[0].screenX;
      touchStartY = e.changedTouches[0].screenY;
    }, { passive: true });
    document.addEventListener('touchend', function(e) {
      touchEndX = e.changedTouches[0].screenX;
      touchEndY = e.changedTouches[0].screenY;
      handleSwipe();
    }, { passive: true });
    function handleSwipe() {
      const deltaX = touchEndX - touchStartX;
      const deltaY = touchEndY - touchStartY;
      const minSwipeDistance = 50;
      // Only handle horizontal swipes (ignore vertical)
      if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > minSwipeDistance) {
        if (deltaX > 0) {
          // Swipe right - open menu
          $targetEl.classList.remove('hidden');
          // Force reflow
          $targetEl.offsetHeight;
          $targetEl.classList.remove('-translate-x-full');
        } else {
          // Swipe left - close menu
          $targetEl.classList.add('-translate-x-full');
          setTimeout(() => {
            $targetEl.classList.add('hidden');
          }, 300); // Match transition duration
        }
      }
    }
  });
</script>
{{end}}
